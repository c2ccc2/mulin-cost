import{i as x}from"./index-Bb6yjXMn.js";import{_ as v,r as w,b as D,w as S,B as k,J as z,V as A,c as N,o as _,W as B,M as C}from"./index-DOTrAPYh.js";const L={__name:"PersonChart",props:{className:{type:String,default:""},width:{type:String,default:"100%"},height:{type:String,default:"350px"},chartData:{type:[Object,Array],required:!0}},setup(c,{expose:y}){const i=c,u=w(null);let r=null;const d=D(()=>{let e=[];if(Array.isArray(i.chartData))e=i.chartData.filter(n=>n.value>0);else if(i.chartData&&typeof i.chartData=="object"){const n=i.chartData.personNames||[],s=i.chartData.workHours||[];e=n.map((a,o)=>({name:a,value:s[o]||0})).filter(a=>a.value>0)}console.log("Before sorting:",e);const t=e.sort((n,s)=>s.value-n.value);return console.log("After sorting:",t),t});function h(e,t=12){return e?e.length>t?e.substring(0,t-2)+"..":e:""}function p(){u.value&&(r=x(u.value),m())}function m(){if(!r)return;const e=d.value.length>0,t=d.value.slice(0,10).reverse(),n=t.map(a=>h(a.name,10)),s={title:{text:e?"人员工时排行榜 (TOP 10)":"暂无数据",textStyle:{fontSize:16,fontWeight:"bold"},left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:a=>{const o=a[0],l=t.find(f=>h(f.name,10)===o.name),g=l?l.name:o.name;return`排名: 第${t.findIndex(f=>f.name===(l==null?void 0:l.name)||h(f.name,10)===o.name)+1}名<br/>${g}<br/>${o.marker} 工时: ${o.value} 小时`}},grid:{left:"120",right:"30",bottom:"30",top:"60",containLabel:!1},xAxis:{type:"value",axisLabel:{formatter:"{value} h"}},yAxis:{type:"category",data:n,axisLabel:{fontSize:12,margin:15},axisTick:{alignWithLabel:!0}},series:[{name:"工时",type:"bar",data:t.map(a=>a.value),barWidth:20,itemStyle:{color:a=>["#ff6b6b","#ffa726","#5ab1ef","#2ec7c9","#2ec7c9","#2ec7c9","#b6a2de","#b6a2de","#b6a2de","#b6a2de"][a.dataIndex]||"#b6a2de",borderRadius:[0,4,4,0]},emphasis:{itemStyle:{shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.2)"}},label:{show:!0,position:"right",formatter:"{c}h",fontSize:11,color:"#666"}}]};e||(s.title.textStyle.color="#999",s.graphic={type:"text",left:"center",top:"center",style:{text:"暂无数据",fontSize:14,fill:"#999"}}),r.setOption(s,!0)}S(d,()=>{r&&m()},{deep:!0});function b(){r&&r.resize()}return k(()=>{z(()=>{p(),window.addEventListener("resize",b)})}),A(()=>{r&&r.dispose(),window.removeEventListener("resize",b)}),y({initChart:p}),(e,t)=>(_(),N("div",{class:C(c.className),style:B({height:c.height,width:c.width}),ref_key:"chartRef",ref:u},null,6))}},$=v(L,[["__scopeId","data-v-7805da15"]]);export{$ as default};
