import{i as y}from"./index-Bb6yjXMn.js";import{_ as b,r as v,b as w,w as S,B as z,J as N,V as x,c as D,o as k,W as C,M as _}from"./index-DOTrAPYh.js";const $={__name:"PieChart",props:{className:{type:String,default:""},width:{type:String,default:"100%"},height:{type:String,default:"350px"},chartData:{type:[Object,Array],required:!0}},setup(s,{expose:m}){const n=s,c=v(null);let a=null;const g=["#5b8ff9","#5ad8a6","#5d7092","#f6bd16","#e868ab","#6dc8ec","#9270ca","#ff9d4d","#269a99","#ff99c3"],i=w(()=>{if(Array.isArray(n.chartData))return n.chartData.filter(t=>t.value>0);if(n.chartData&&typeof n.chartData=="object"){const t=n.chartData.projectNames||[],r=n.chartData.workHours||[];return t.map((o,l)=>({name:o,value:r[l]||0})).filter(o=>o.value>0)}return[]});function d(t,r=12){return t?t.length>r?t.substring(0,r-2)+"..":t:""}function u(){c.value&&(a=y(c.value),h())}function h(){if(!a)return;const t=i.value.length>0,r=t&&i.value.length<=6&&i.value.every(e=>e.name.length<=10),o=i.value.map((e,f)=>({...e,id:f,displayName:d(e.name,10),legendName:d(e.name,15)})),l={color:g,title:{text:t?"项目工时分布":"暂无数据",textStyle:{fontSize:16,fontWeight:"bold"},left:"center"},tooltip:{trigger:"item",formatter:e=>{const f=e.data.originalName||e.name;return`${e.seriesName} <br/>${f} : ${e.value}小时 (${e.percent}%)`}},legend:{type:"scroll",orient:"horizontal",bottom:10,left:"center",data:o.map(e=>({name:e.legendName,icon:"circle"})),textStyle:{fontSize:12},pageIconSize:12,pageTextStyle:{fontSize:12},tooltip:{show:!0}},series:[{name:"项目工时",type:"pie",radius:["40%","70%"],center:["50%","45%"],avoidLabelOverlap:!1,itemStyle:{borderRadius:6,borderColor:"#fff",borderWidth:2},label:{show:r,formatter:e=>`{b|${e.name}}
{per|${e.percent}%}`,rich:{b:{fontSize:11,lineHeight:16},per:{fontSize:10,color:"#999",lineHeight:14}}},labelLine:{show:r,length:10,length2:8},data:o.map(e=>({...e,name:e.legendName,originalName:e.name})),emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.2)"}}}]};t||(l.title.textStyle.color="#999",l.graphic={type:"text",left:"center",top:"center",style:{text:"暂无数据",fontSize:14,fill:"#999"}}),a.setOption(l,!0)}S(i,()=>{a&&h()},{deep:!0});function p(){a&&a.resize()}return z(()=>{N(()=>{u(),window.addEventListener("resize",p)})}),x(()=>{a&&a.dispose(),window.removeEventListener("resize",p)}),m({initChart:u}),(t,r)=>(k(),D("div",{class:_(s.className),style:C({height:s.height,width:s.width}),ref_key:"chartRef",ref:c},null,6))}},j=b($,[["__scopeId","data-v-2d5fbe9b"]]);export{j as default};
